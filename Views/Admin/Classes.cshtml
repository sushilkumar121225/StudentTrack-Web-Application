@{
    ViewData["Title"] = "Manage Classes";
}

<div class="container mt-5">
    <h2 class="fw-bold text-danger mb-4">🏫 Classes</h2>

    <hr class="my-4">

    <h4 class="mb-3 text-primary">➕ Add / Edit Class</h4>
    <form id="classForm" class="row g-3">
        <div class="col-md-4">
            <label class="form-label">Class Name</label>
            <input type="text" class="form-control" id="className" required>
        </div>

        <div class="col-md-2">
            <label class="form-label">Section</label>
            <input type="text" class="form-control" id="classSection" required>
        </div>

        <div class="col-md-3">
            <label class="form-label">Course</label>
            <select class="form-select" id="courseSelect" required>
                <option value="">Select Course</option>
                <option>B.Tech</option>
                <option>Management</option>
                <option>Law</option>
                <option>Science</option>
                <option>Arts</option>
                <option>Nursing</option>
            </select>
        </div>

        <div class="col-md-3">
            <label class="form-label">Class Type</label>
            <select class="form-select" id="classTypeSelect" required>
                <option value="">Select Type</option>
                <option>Lecture</option>
                <option>Lab</option>
                <option>Seminar</option>
                <option>Workshop</option>
                <option>Research Work</option>
            </select>
        </div>

        <div class="col-md-3">
            <label class="form-label">Seat Capacity</label>
            <input type="number" class="form-control" id="seatCapacity" required min="1">
        </div>

        <div class="col-md-3">
            <label class="form-label">Location</label>
            <input type="text" class="form-control" id="location" required>
        </div>

        <div class="col-md-3">
            <label class="form-label">Floor</label>
            <input type="text" class="form-control" id="floor" required>
        </div>

        <div class="col-md-3">
            <label class="form-label">Description</label>
            <input type="text" class="form-control" id="description">
        </div>

        <div class="col-12 mt-3">
            <button type="submit" class="btn btn-success">Add Class</button>
        </div>
    </form>

    <hr class="my-5">

    <h3 class="fw-bold text-secondary mb-4">🏷️ Classes by Course & Type</h3>

    <div id="classesContainer">
        <!-- Dynamic course and type sections will appear here -->
    </div>
</div>

@section Scripts {
    <script>
        const classForm = document.getElementById("classForm");
        const classesContainer = document.getElementById("classesContainer");

        // Data storage
        const classesData = {};

        classForm.addEventListener("submit", function (e) {
            e.preventDefault();

            const name = document.getElementById("className").value;
            const section = document.getElementById("classSection").value;
            const course = document.getElementById("courseSelect").value;
            const classType = document.getElementById("classTypeSelect").value;
            const capacity = document.getElementById("seatCapacity").value;
            const location = document.getElementById("location").value;
            const floor = document.getElementById("floor").value;
            const description = document.getElementById("description").value;

            if (!classesData[course]) classesData[course] = {};
            if (!classesData[course][classType]) classesData[course][classType] = [];

            classesData[course][classType].push({
                name, section, capacity, location, floor, description
            });

            renderClasses();
            classForm.reset();
        });

        function renderClasses() {
            classesContainer.innerHTML = "";

            for (const course in classesData) {
                const courseDiv = document.createElement("div");
                courseDiv.classList.add("mb-5");

                const courseTitle = document.createElement("h4");
                courseTitle.textContent = `🎓 ${course}`;
                courseTitle.classList.add("text-primary", "mb-3");
                courseDiv.appendChild(courseTitle);

                for (const classType in classesData[course]) {
                    const typeDiv = document.createElement("div");
                    typeDiv.classList.add("mb-3");

                    const typeTitle = document.createElement("h5");
                    typeTitle.textContent = `🏷️ ${classType}`;
                    typeTitle.classList.add("text-success", "mb-2");
                    typeDiv.appendChild(typeTitle);

                    const table = document.createElement("table");
                    table.classList.add("table", "table-striped", "table-hover", "shadow", "rounded");

                    const thead = document.createElement("thead");
                    thead.classList.add("table-danger");
                    thead.innerHTML = `
                        <tr>
                            <th>ID</th>
                            <th>Class Name</th>
                            <th>Section</th>
                            <th>Seat Capacity</th>
                            <th>Location</th>
                            <th>Floor</th>
                            <th>Description</th>
                        </tr>
                    `;
                    table.appendChild(thead);

                    const tbody = document.createElement("tbody");

                    classesData[course][classType].forEach((cls, index) => {
                        const tr = document.createElement("tr");
                        tr.innerHTML = `
                            <td>${index + 1}</td>
                            <td>${cls.name}</td>
                            <td>${cls.section}</td>
                            <td>${cls.capacity}</td>
                            <td>${cls.location}</td>
                            <td>${cls.floor}</td>
                            <td>${cls.description}</td>
                        `;
                        tbody.appendChild(tr);
                    });

                    table.appendChild(tbody);
                    typeDiv.appendChild(table);
                    courseDiv.appendChild(typeDiv);
                }

                classesContainer.appendChild(courseDiv);
            }
        }
    </script>
}
